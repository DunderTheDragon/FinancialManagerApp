<UserControl x:Class="FinancialManagerApp.Views.GoalsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             Background="#ECF0F1">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </UserControl.Resources>

    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Margin="0,0,0,25">
            <TextBlock Text="Cele Oszczędnościowe (Skarbonki)" FontSize="24" FontWeight="Bold" Foreground="#2C3E50" VerticalAlignment="Center"/>
            <Button Content="+ Utwórz skarbonkę" Background="#1ABC9C" Foreground="White" Margin="30,0,0,0" Padding="15,8" FontWeight="SemiBold" Cursor="Hand" Command="{Binding OpenAddGoalCommand}"/>
        </StackPanel>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding SavingsGoals}">
                <d:ItemsControl.ItemsSource>
                    <x:Array Type="{x:Type sys:Object}">
                        <sys:Object />
                    </x:Array>
                </d:ItemsControl.ItemsSource>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="White" CornerRadius="12" Padding="20" Margin="0,0,10,15" BorderBrush="#D5DBDB" BorderThickness="1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="250"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="{Binding GoalName, FallbackValue='Wakacje w Hiszpanii'}" FontSize="20" FontWeight="Bold" Foreground="#2C3E50"/>

                                        <Border Visibility="Visible" Background="#EBF5FB" CornerRadius="5" Margin="15,0,0,0" Padding="8,2" VerticalAlignment="Center">
                                            <TextBlock Text="WPŁATY CYKLICZNE" FontSize="9" Foreground="#3498DB" FontWeight="Bold"/>
                                        </Border>
                                    </DockPanel>

                                    <TextBlock Text="{Binding EstimatedDate, StringFormat='Szacowana data realizacji: {0:dd.MM.yyyy}', FallbackValue='Szacowana data realizacji: 15.08.2026'}" 
                                               FontSize="13" Foreground="#7F8C8D" Margin="0,8,0,5"/>

                                    <TextBlock Text="{Binding ContributionInfo, FallbackValue='Odkładasz 10% miesięcznych wpływów'}" FontSize="11" Foreground="#95A5A6" FontStyle="Italic" Margin="0,0,0,15"/>

                                    <Grid Margin="0,5,0,0">
                                        <ProgressBar Value="{Binding ProgressPercentage, Mode=OneWay}" 
                                        Height="20" Margin="0,10,0,0" Foreground="#1ABC9C"/>
                                        <TextBlock Text="{Binding ProgressPercentage, StringFormat={}{0:F0}%, FallbackValue=65%}" 
                                                   HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="11" FontWeight="Bold" Foreground="#2C3E50"/>
                                    </Grid>
                                </StackPanel>

                                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="30,0,0,0">
                                    <TextBlock Text="{Binding CurrentAmount, StringFormat={}{0:N2} zł, FallbackValue='3 250,00 zł'}" FontSize="22" FontWeight="Bold" Foreground="#1ABC9C" HorizontalAlignment="Right"/>
                                    <TextBlock Text="{Binding TargetAmount, StringFormat='z {0:N2} zł', FallbackValue='z 5 000,00 zł'}" FontSize="14" Foreground="#BDC3C7" HorizontalAlignment="Right" Margin="0,0,0,15"/>

                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Button Content="Wpłać" Command="{Binding DataContext.OpenDepositCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Background="#3498DB" Foreground="White" Width="60" Margin="3,0" Padding="5,4" FontSize="10" FontWeight="SemiBold"/>
                                        <Button Content="Edytuj" Command="{Binding DataContext.OpenEditGoalCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Background="#F39C12" Foreground="White" Width="60" Margin="3,0" Padding="5,4" FontSize="10" FontWeight="SemiBold"/>
                                        <Button Content="Usuń" Command="{Binding DataContext.DeleteGoalCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Background="#E74C3C" Foreground="White" Width="60" Margin="3,0" Padding="5,4" FontSize="10" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>